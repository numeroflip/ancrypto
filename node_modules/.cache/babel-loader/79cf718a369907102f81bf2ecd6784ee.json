{"ast":null,"code":"var _jsxFileName = \"/home/aronberenyi/Code/ancrypto/src/components/App/AppProvider.js\";\nimport React, { useState, useEffect } from 'react';\nimport cc, { price } from 'cryptocompare';\nimport { render } from '@testing-library/react';\nimport { filter } from 'lodash';\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707');\nexport const AppContext = React.createContext();\nconst MAX_FAVOURITES = 10;\nexport default (({\n  children\n}) => {\n  // ==============STATE========================\n  // const [page, setPage] = useState('dashboard');\n  // const [firstVisit, setFirstVisit] = useState([])\n  //useState(localStorage.getItem('ancrypto') ? false : true)\n  // const [favourites, setFavourites] =  useState([])\n  //useState(firstVisit ? [] : getFavsFromLocal());\n  const [coinList, setCoinList] = useState(null);\n  const [filteredCoins, setFilteredCoins] = useState([]);\n  const [prices, setPrices] = useState([]);\n  console.log('APP PROVIDER=================================');\n\n  function getFavsFromLocal() {\n    let data = JSON.parse(localStorage.getItem('ancrypto'));\n    let favs = data.favourites;\n    return favs ? favs : [];\n  }\n\n  const getPrices = async () => {\n    const returnData = [];\n    favourites.forEach(async favourite => {\n      try {\n        let priceData = await cc.priceFull(favourite, 'USD');\n        returnData.push(priceData);\n      } catch (e) {\n        console.warn('Fetch price error: ', e);\n      }\n    });\n    return returnData;\n  };\n\n  const addCoin = coinKey => {\n    if (favourites.length < MAX_FAVOURITES && !favourites.includes(coinKey)) {\n      console.log('----SetFavourites----');\n      setFavourites([...favourites, coinKey]);\n    }\n  };\n\n  const updateFavsInLocalStorage = favourites => {\n    console.log('---UpdateFavsInLocalStorage---');\n    localStorage.setItem('ancrypto', JSON.stringify({\n      favourites\n    }));\n  };\n\n  useEffect(() => {\n    console.warn('////Some Data changed (Or init when first called)////');\n    console.log('---coinList', coinList);\n    console.log('---filteredCoins', filteredCoins);\n    console.log('---prices', prices);\n    console.log('---favourites: ', favourites);\n  }, [page, firstVisit, favourites, coinList, filteredCoins, prices]); // Write favourites into localstorage\n\n  useEffect(() => updateFavsInLocalStorage(favourites), [favourites]);\n\n  const fetchPrices = async () => {\n    let prices = await getPrices();\n    console.log('***prices, fetchedPrices: ', prices);\n    return prices;\n  }; // Fetch Data at startup\n\n\n  useEffect(() => {\n    const fetchCoins = async () => {\n      console.log('=============FETCHCOIN HAPPENED===============');\n      let coins = await cc.coinList();\n      console.log('==COINS ARRIVED==');\n      coins = coins.Data;\n\n      try {\n        return coins;\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    async function initData() {\n      console.warn('////--STARTER DATA--////');\n      console.log('====STARTUP==== (fetchCoins and fetchPrices)');\n      console.log('==> fetching coins');\n      const coins = await fetchCoins();\n      console.log('//coins fetched');\n      console.log('==> fetching prices');\n      console.log('// Prices are fetched');\n      const prices = await fetchPrices();\n      setCoinList(coins);\n      console.log('// Coins are set');\n      setPrices(prices);\n      console.log('==> Prices are set');\n    }\n\n    initData();\n  }, []);\n\n  const isInFavourites = coinKey => {\n    return favourites.includes(coinKey);\n  };\n\n  const removeCoin = coinKey => {\n    setFavourites(favourites.filter(key => key !== coinKey));\n  };\n\n  return /*#__PURE__*/React.createElement(AppContext.Provider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 5\n    }\n  }, children);\n});","map":{"version":3,"sources":["/home/aronberenyi/Code/ancrypto/src/components/App/AppProvider.js"],"names":["React","useState","useEffect","cc","price","render","filter","setApiKey","AppContext","createContext","MAX_FAVOURITES","children","coinList","setCoinList","filteredCoins","setFilteredCoins","prices","setPrices","console","log","getFavsFromLocal","data","JSON","parse","localStorage","getItem","favs","favourites","getPrices","returnData","forEach","favourite","priceData","priceFull","push","e","warn","addCoin","coinKey","length","includes","setFavourites","updateFavsInLocalStorage","setItem","stringify","page","firstVisit","fetchPrices","fetchCoins","coins","Data","initData","isInFavourites","removeCoin","key"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport cc, { price } from 'cryptocompare'\nimport { render } from '@testing-library/react';\nimport { filter } from 'lodash';\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707')\nexport const AppContext = React.createContext();\n\nconst MAX_FAVOURITES = 10;\n\n\n\nexport default ({children}) => {\n\n    // ==============STATE========================\n    // const [page, setPage] = useState('dashboard');\n    // const [firstVisit, setFirstVisit] = useState([])\n    //useState(localStorage.getItem('ancrypto') ? false : true)\n    // const [favourites, setFavourites] =  useState([])\n    //useState(firstVisit ? [] : getFavsFromLocal());\n    const [coinList, setCoinList] = useState(null)\n    const [filteredCoins, setFilteredCoins] = useState([])\n    const [prices, setPrices] = useState([]);\n\n    console.log('APP PROVIDER=================================')\n\n\n    function getFavsFromLocal() {\n        let data = JSON.parse(localStorage.getItem('ancrypto'))\n        let favs = data.favourites;\n        return favs ? favs : []\n    }\n    \n \n    \n    const getPrices = async () => {\n        const returnData = [];\n        favourites.forEach(async favourite => {\n            try {\n                let priceData = await cc.priceFull(favourite, 'USD');\n                returnData.push(priceData)\n            } catch(e) { console.warn('Fetch price error: ', e) }\n        }) \n        return returnData\n    }\n\n    \n\n\n    const addCoin = coinKey => {\n        if((favourites.length < MAX_FAVOURITES ) && !favourites.includes(coinKey)) {\n            console.log('----SetFavourites----')\n            setFavourites([...favourites, coinKey]);\n        }\n    }\n    const updateFavsInLocalStorage = (favourites) => {\n        console.log('---UpdateFavsInLocalStorage---')\n\n        localStorage.setItem('ancrypto', JSON.stringify({favourites}))\n    }\n\n    useEffect(() => {\n        console.warn('////Some Data changed (Or init when first called)////')\n        console.log('---coinList' , coinList)\n        console.log('---filteredCoins', filteredCoins)\n        console.log('---prices', prices)\n        console.log('---favourites: ', favourites)\n    }, [page, firstVisit, favourites, coinList, filteredCoins, prices])\n    // Write favourites into localstorage\n    useEffect(() => updateFavsInLocalStorage(favourites), [favourites])\n\n    const fetchPrices = async () => {\n        let prices = await getPrices()\n        console.log('***prices, fetchedPrices: ', prices)\n        return prices\n    }\n    // Fetch Data at startup\n    useEffect( () => {\n\n        const fetchCoins = async () => {\n            console.log('=============FETCHCOIN HAPPENED===============')\n            let coins = await cc.coinList()\n            console.log('==COINS ARRIVED==')\n            coins = coins.Data\n            try {return coins}\n            catch(e) {console.log(e)}\n        }\n\n\n\n        async function initData() {\n            console.warn('////--STARTER DATA--////')\n            console.log('====STARTUP==== (fetchCoins and fetchPrices)')\n            console.log('==> fetching coins')\n            const coins = await fetchCoins();\n            console.log('//coins fetched')\n            console.log('==> fetching prices')\n            console.log('// Prices are fetched')\n            const prices = await fetchPrices()\n            setCoinList(coins)\n            console.log('// Coins are set')\n            setPrices(prices);\n            console.log('==> Prices are set')\n        }\n\n            initData()\n    }, [])\n\n\n    const isInFavourites = (coinKey) => {\n        return favourites.includes(coinKey)\n    } \n\n    const removeCoin = coinKey => {\n        setFavourites(favourites.filter(key => key !== coinKey))\n    }\n\n\n    return (\n    <AppContext.Provider \n    // value={\n    //     {\n    //         page, \n    //         coinList, \n    //         setPage, \n    //         favourites,\n    //         isInFavourites,\n    //         setFavourites, \n    //         filteredCoins,\n    //         setFilteredCoins,\n    //         addCoin, \n    //         removeCoin, \n    //         firstVisit\n    //     }\n    // }\n    >{children}</AppContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}