{"ast":null,"code":"var _jsxFileName = \"/home/aronberenyi/Code/ancrypto/src/components/contexts/DataContext.js\";\nimport React, { useState, useEffect } from 'react';\nimport cc from 'cryptocompare';\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707');\nconst MAX_FAVOURITES = 10;\nexport const DataContext = React.createContext();\nexport const DataProvider = ({\n  children\n}) => {\n  // ==============STATE========================\n  const [page, setPage] = useState('dashboard');\n  const [firstVisit, setFirstVisit] = useState(localStorage.getItem('ancrypto') ? false : true);\n  const [favourites, setFavourites] = useState(firstVisit ? [] : getFavsFromLocal());\n  const [coinList, setCoinList] = useState(null);\n  const [filteredCoins, setFilteredCoins] = useState([]);\n  const [prices, setPrices] = useState([]);\n\n  function getFavsFromLocal() {\n    let data = JSON.parse(localStorage.getItem('ancrypto'));\n    let favs = data.favourites;\n    return favs ? favs : [];\n  }\n\n  const addCoin = coinKey => {\n    if (favourites.length < MAX_FAVOURITES && !favourites.includes(coinKey)) {\n      setFavourites([...favourites, coinKey]);\n    }\n  };\n\n  const updateFavsInLocalStorage = favourites => {\n    localStorage.setItem('ancrypto', JSON.stringify({\n      favourites\n    }));\n  }; // Write favourites into localstorage\n\n\n  useEffect(() => updateFavsInLocalStorage(favourites), [favourites]); // Fetch Coin data at startup\n\n  useEffect(() => {\n    const fetchCoins = async () => {\n      let coins = await cc.coinList();\n      coins = coins.Data;\n\n      try {\n        return coins;\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    const updateStateWithCoins = async () => {\n      const coins = await fetchCoins();\n      const prices = await fetchPrices();\n      setCoinList(coins);\n      setPrices(prices);\n    };\n\n    updateStateWithCoins();\n  }, []); // Fetch the pices of favourites\n\n  useEffect(() => {\n    const fetchPrices = async coinsArr => {\n      try {\n        const returnData = [];\n        coinsArr.forEach(async coin => {\n          try {\n            let priceData = await cc.priceFull(coin, 'USD');\n            returnData.push(priceData);\n          } catch (e) {\n            console.error('Fetch price error: ', e);\n          }\n        });\n        return returnData;\n      } catch (e) {\n        console.error('Fetch price error: ', e);\n      }\n    };\n\n    const updatePrices = async coinsArr => {\n      let prices = await fetchPrices(coinsArr);\n      prices.length > 0 ? setPrices(prices) : setPrices([]);\n    };\n\n    updatePrices(favourites);\n  }, [favourites]);\n\n  const isInFavourites = coinKey => {\n    return favourites.includes(coinKey);\n  };\n\n  const removeCoin = coinKey => {\n    setFavourites(favourites.filter(key => key !== coinKey));\n  };\n\n  return /*#__PURE__*/React.createElement(DataContext.Provider, {\n    value: {\n      page,\n      coinList,\n      setPage,\n      favourites,\n      isInFavourites,\n      setFavourites,\n      filteredCoins,\n      setFilteredCoins,\n      addCoin,\n      removeCoin,\n      firstVisit\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 5\n    }\n  }, children);\n};","map":{"version":3,"sources":["/home/aronberenyi/Code/ancrypto/src/components/contexts/DataContext.js"],"names":["React","useState","useEffect","cc","setApiKey","MAX_FAVOURITES","DataContext","createContext","DataProvider","children","page","setPage","firstVisit","setFirstVisit","localStorage","getItem","favourites","setFavourites","getFavsFromLocal","coinList","setCoinList","filteredCoins","setFilteredCoins","prices","setPrices","data","JSON","parse","favs","addCoin","coinKey","length","includes","updateFavsInLocalStorage","setItem","stringify","fetchCoins","coins","Data","e","console","log","updateStateWithCoins","fetchPrices","coinsArr","returnData","forEach","coin","priceData","priceFull","push","error","updatePrices","isInFavourites","removeCoin","filter","key"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport cc from 'cryptocompare'\n\n\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707')\n\nconst MAX_FAVOURITES = 10;\n\nexport const DataContext = React.createContext();\n\n\n\nexport const DataProvider = ({children}) => {\n\n    // ==============STATE========================\n    const [page, setPage] = useState('dashboard');\n    const [firstVisit, setFirstVisit] = useState(localStorage.getItem('ancrypto') ? false : true)\n    const [favourites, setFavourites] = useState(firstVisit ? [] : getFavsFromLocal());\n    const [coinList, setCoinList] = useState(null)\n    const [filteredCoins, setFilteredCoins] = useState([])\n    const [prices, setPrices] = useState([]);\n\n\n    function getFavsFromLocal() {\n        let data = JSON.parse(localStorage.getItem('ancrypto'))\n        let favs = data.favourites;\n        return favs ? favs : []\n    }\n    \n\n    \n  \n\n    \n\n\n    const addCoin = coinKey => {\n        if((favourites.length < MAX_FAVOURITES ) && !favourites.includes(coinKey)) {\n            setFavourites([...favourites, coinKey]);\n        }\n    }\n    const updateFavsInLocalStorage = (favourites) => {\n        localStorage.setItem('ancrypto', JSON.stringify({favourites}))\n    }\n\n    // Write favourites into localstorage\n    useEffect(() => updateFavsInLocalStorage(favourites), [favourites])\n\n    // Fetch Coin data at startup\n    useEffect(() => {\n        const fetchCoins = async () => {\n          let coins = await cc.coinList()\n          coins = coins.Data\n          try {return coins}\n          catch(e) {console.log(e)}\n      }\n        const updateStateWithCoins = async () => {\n            const coins = await fetchCoins()\n            const prices = await fetchPrices()\n            setCoinList(coins)\n            setPrices(prices)\n        }\n    \n        updateStateWithCoins()\n    \n      }, [])\n\n    // Fetch the pices of favourites\n    useEffect(() => {\n        \n        const fetchPrices = async (coinsArr) => {\n            try {\n                const returnData = [];\n                coinsArr.forEach(async (coin) => {\n                    try {\n                        let priceData = await cc.priceFull(coin, 'USD');\n                        returnData.push(priceData)\n                    } catch(e) { console.error('Fetch price error: ', e) }\n                })\n                return returnData\n            } catch (e) { console.error('Fetch price error: ', e)}\n        }\n        const updatePrices = async (coinsArr) => {\n            let prices = await fetchPrices(coinsArr)\n            prices.length > 0 ? setPrices(prices) : setPrices([])\n            \n        }\n        updatePrices(favourites) \n    },[favourites])\n\n\n\n    const isInFavourites = (coinKey) => {\n        return favourites.includes(coinKey)\n    } \n\n    const removeCoin = coinKey => {\n        setFavourites(favourites.filter(key => key !== coinKey))\n    }\n\n    return (\n    <DataContext.Provider value={\n        {\n            page, \n            coinList,\n            setPage, \n            favourites,\n            isInFavourites,\n            setFavourites, \n            filteredCoins,\n            setFilteredCoins,\n            addCoin, \n            removeCoin, \n            firstVisit\n        }\n    }>{children}</DataContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}