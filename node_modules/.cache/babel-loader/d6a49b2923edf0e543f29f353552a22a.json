{"ast":null,"code":"var _jsxFileName = \"/home/aronberenyi/Code/ancrypto/src/components/App/AppProvider.js\";\nimport React, { useState, useEffect } from 'react';\nimport cc, { price } from 'cryptocompare';\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707');\nexport const AppContext = React.createContext();\nconst MAX_FAVOURITES = 10;\nexport default (({\n  children\n}) => {\n  // ==============STATE========================\n  const [page, setPage] = useState('dashboard');\n  const [firstVisit, setFirstVisit] = useState(localStorage.getItem('ancrypto') ? false : true);\n  const [favourites, setFavourites] = useState(firstVisit ? [] : getFavsFromLocal());\n  const [coinList, setCoinList] = useState(null);\n  const [filteredCoins, setFilteredCoins] = useState([]);\n  const [prices, setPrices] = useState([]);\n  console.log('APP PROVIDER=================================');\n  console.log('---coinList', coinList);\n  console.log('---filteredCoins', filteredCoins);\n  console.log('---prices', prices);\n\n  function getFavsFromLocal() {\n    let data = JSON.parse(localStorage.getItem('ancrypto'));\n    let favs = data.favourites;\n    console.log('+++ Favourites: ', favs);\n    return favs ? favs : [];\n  }\n\n  const getPrices = async () => {\n    try {\n      const returnData = [];\n      favourites.forEach(async favourite => {\n        try {\n          let priceData = await cc.priceFull(favourite, 'USD');\n          console.log('BUBUBUBUBUb', favourite, priceData);\n          returnData.push(priceData);\n        } catch (e) {\n          console.warn('Fetch price error: ', e);\n        }\n      });\n      console.log('<< getPrices returned array: ', returnData);\n      return returnData;\n    } catch (e) {\n      console.warn('Fetch price error: ', e);\n    }\n  };\n\n  const fetchPrices = async () => {\n    let prices = await getPrices();\n    console.log('<< fetched prices: ', prices);\n    setPrices(prices);\n  };\n\n  const addCoin = coinKey => {\n    if (favourites.length < MAX_FAVOURITES && !favourites.includes(coinKey)) {\n      setFavourites([...favourites, coinKey]);\n    }\n  };\n\n  const updateFavsInLocalStorage = favourites => {\n    localStorage.setItem('ancrypto', JSON.stringify({\n      favourites\n    }));\n  }; // Write favourites into localstorage\n\n\n  useEffect(() => updateFavsInLocalStorage(favourites), [favourites]); // Fetch Data at startup\n\n  useEffect(() => {\n    const fetchCoins = async () => {\n      let coins = await cc.coinList();\n      coins = coins.Data;\n\n      try {\n        return coins;\n      } catch (e) {\n        console.log(e);\n      }\n    };\n\n    const updateStateWithCoinsAndPrices = async () => {\n      console.log('===========Fetching Coins');\n      const coins = await fetchCoins();\n      console.log('<<<<<<Coins arrived');\n      console.log('===========Fetching Prices');\n      const prices = await fetchPrices();\n      console.log('<<<<<<Prices arrived');\n      setCoinList(coins);\n      setPrices(prices);\n    };\n\n    updateStateWithCoinsAndPrices();\n  }, []);\n\n  const isInFavourites = coinKey => {\n    return favourites.includes(coinKey);\n  };\n\n  const removeCoin = coinKey => {\n    setFavourites(favourites.filter(key => key !== coinKey));\n  };\n\n  return /*#__PURE__*/React.createElement(AppContext.Provider, {\n    value: {\n      page,\n      coinList,\n      setCoinList,\n      setPage,\n      favourites,\n      isInFavourites,\n      setFavourites,\n      filteredCoins,\n      setFilteredCoins,\n      addCoin,\n      removeCoin,\n      firstVisit\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 5\n    }\n  }, children);\n});","map":{"version":3,"sources":["/home/aronberenyi/Code/ancrypto/src/components/App/AppProvider.js"],"names":["React","useState","useEffect","cc","price","setApiKey","AppContext","createContext","MAX_FAVOURITES","children","page","setPage","firstVisit","setFirstVisit","localStorage","getItem","favourites","setFavourites","getFavsFromLocal","coinList","setCoinList","filteredCoins","setFilteredCoins","prices","setPrices","console","log","data","JSON","parse","favs","getPrices","returnData","forEach","favourite","priceData","priceFull","push","e","warn","fetchPrices","addCoin","coinKey","length","includes","updateFavsInLocalStorage","setItem","stringify","fetchCoins","coins","Data","updateStateWithCoinsAndPrices","isInFavourites","removeCoin","filter","key"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react'\nimport cc, { price } from 'cryptocompare'\n\n\ncc.setApiKey('6bce00cebd36b06c07f20e0e94c2a0fe1b0211dc0a8a8dc030f6fb8b4117f707')\n\n\nexport const AppContext = React.createContext();\n\nconst MAX_FAVOURITES = 10;\n\nexport default ({children}) => {\n\n    // ==============STATE========================\n    const [page, setPage] = useState('dashboard');\n    const [firstVisit, setFirstVisit] = useState(localStorage.getItem('ancrypto') ? false : true)\n    const [favourites, setFavourites] = useState(firstVisit ? [] : getFavsFromLocal());\n    const [coinList, setCoinList] = useState(null)\n    const [filteredCoins, setFilteredCoins] = useState([])\n    const [prices, setPrices] = useState([]);\n\n    console.log('APP PROVIDER=================================')\n    console.log('---coinList', coinList)\n    console.log('---filteredCoins', filteredCoins)\n    console.log('---prices', prices)\n    \n\n    function getFavsFromLocal() {\n        let data = JSON.parse(localStorage.getItem('ancrypto'))\n        let favs = data.favourites;\n        console.log('+++ Favourites: ', favs)\n        return favs ? favs : []\n    }\n    \n\n    \n    const getPrices = async () => {\n        try {\n            const returnData = [];\n            favourites.forEach(async (favourite) => {\n                try {\n                    let priceData = await cc.priceFull(favourite, 'USD');\n                    console.log('BUBUBUBUBUb', favourite, priceData)\n                    returnData.push(priceData)\n                } catch(e) { console.warn('Fetch price error: ', e) }\n            })\n            \n            console.log('<< getPrices returned array: ', returnData)\n            return returnData\n        } catch (e) { console.warn('Fetch price error: ', e)}\n    }\n    const fetchPrices = async () => {\n        let prices = await getPrices()\n        console.log('<< fetched prices: ', prices)\n        setPrices(prices)\n    }\n    \n\n\n    const addCoin = coinKey => {\n        if((favourites.length < MAX_FAVOURITES ) && !favourites.includes(coinKey)) {\n            setFavourites([...favourites, coinKey]);\n        }\n    }\n    const updateFavsInLocalStorage = (favourites) => {\n        localStorage.setItem('ancrypto', JSON.stringify({favourites}))\n    }\n\n    // Write favourites into localstorage\n    useEffect(() => updateFavsInLocalStorage(favourites), [favourites])\n\n    // Fetch Data at startup\n    useEffect(() => {\n        const fetchCoins = async () => {\n          let coins = await cc.coinList()\n          coins = coins.Data\n          try {return coins}\n          catch(e) {console.log(e)}\n      }\n        const updateStateWithCoinsAndPrices = async () => {\n            console.log('===========Fetching Coins')\n            const coins = await fetchCoins()\n            console.log('<<<<<<Coins arrived')\n            console.log('===========Fetching Prices')\n            const prices = await fetchPrices()\n            console.log('<<<<<<Prices arrived')\n            setCoinList(coins)\n            setPrices(prices)\n        }\n    \n        updateStateWithCoinsAndPrices()\n    \n      }, [])\n\n    const isInFavourites = (coinKey) => {\n        return favourites.includes(coinKey)\n    } \n\n    const removeCoin = coinKey => {\n        setFavourites(favourites.filter(key => key !== coinKey))\n    }\n\n    return (\n    <AppContext.Provider value={\n        {\n            page, \n            coinList,\n            setCoinList, \n            setPage, \n            favourites,\n            isInFavourites,\n            setFavourites, \n            filteredCoins,\n            setFilteredCoins,\n            addCoin, \n            removeCoin, \n            firstVisit\n        }\n    }>{children}</AppContext.Provider>\n    )\n}"]},"metadata":{},"sourceType":"module"}